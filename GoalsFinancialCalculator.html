<!DOCTYPE html>
<html dir="rtl" lang="he">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>מחשבון מטרות פיננסיות — גרסה פרימיום</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!-- KaTeX Support -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap"
    rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-zoom/2.0.1/chartjs-plugin-zoom.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.4.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-3d/dist/chartjs-plugin-3d.min.js"></script>

  <style>
    :root {
      /* Sophisticated Dark Palette */
      --bg-primary: #050507;
      --bg-secondary: #0a0a0d;
      --bg-tertiary: #0f0f14;
      --bg-card: #141419;
      --bg-elevated: #1a1a20;
      --bg-glass: rgba(20, 20, 25, 0.8);
      --bg-gradient: linear-gradient(135deg, #050507 0%, #0a0a0d 30%, #0f0f14 100%);

      /* Glass Morphism */
      --surface-glass-1: linear-gradient(135deg, rgba(20, 20, 25, 0.95) 0%, rgba(26, 26, 32, 0.9) 100%);
      --surface-glass-2: linear-gradient(135deg, rgba(26, 26, 32, 0.9) 0%, rgba(35, 35, 42, 0.85) 100%);
      --surface-glass-3: linear-gradient(135deg, rgba(35, 35, 42, 0.85) 0%, rgba(45, 45, 54, 0.8) 100%);

      /* Premium Text */
      --text-primary: #ffffff;
      --text-secondary: #e2e8f0;
      --text-muted: #cbd5e1;
      --text-dim: #94a3b8;
      --text-faded: #64748b;

      /* Luxurious Brand Colors */
      --accent-primary: #06b6d4;
      --accent-secondary: #0891b2;
      --accent-gradient: linear-gradient(135deg, #06b6d4 0%, #0891b2 50%, #0e7490 100%);
      --accent-glow: rgba(6, 182, 212, 0.4);

      /* Premium Gold Accent */
      --gold-primary: #fbbf24;
      --gold-secondary: #f59e0b;
      --gold-gradient: linear-gradient(135deg, #fbbf24 0%, #f59e0b 50%, #d97706 100%);
      --gold-glow: rgba(251, 191, 36, 0.3);

      /* Status Colors */
      --success: #10b981;
      --success-glow: rgba(16, 185, 129, 0.2);
      --warning: #f59e0b;
      --warning-glow: rgba(245, 158, 11, 0.2);
      --danger: #ef4444;
      --danger-glow: rgba(239, 68, 68, 0.2);

      /* Advanced Shadows & Effects */
      --shadow-ambient: 0 4px 24px rgba(0, 0, 0, 0.3);
      --shadow-elevated: 0 8px 40px rgba(0, 0, 0, 0.4);
      --shadow-floating: 0 16px 64px rgba(0, 0, 0, 0.5);
      --shadow-glow-blue: 0 0 40px rgba(6, 182, 212, 0.15);
      --shadow-glow-gold: 0 0 40px rgba(251, 191, 36, 0.15);
      --shadow-inner: inset 0 1px 0 rgba(255, 255, 255, 0.1);
      --shadow-depth: inset 0 -1px 0 rgba(0, 0, 0, 0.2);

      /* Borders */
      --border-subtle: rgba(255, 255, 255, 0.06);
      --border-medium: rgba(255, 255, 255, 0.12);
      --border-strong: rgba(255, 255, 255, 0.18);
      --border-accent: rgba(6, 182, 212, 0.4);
      --border-gold: rgba(251, 191, 36, 0.4);

      /* Radius */
      --radius-sm: 8px;
      --radius: 16px;
      --radius-lg: 24px;
      --radius-xl: 32px;
      --radius-2xl: 40px;

      /* Animation */
      --transition-quick: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }



    html,
    body {
      height: 100%;
      overflow-x: hidden;
    }

    body {
      font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg-gradient);
      background-attachment: fixed;
      color: var(--text-primary);
      line-height: 1.7;
      font-size: 21px;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      position: relative;
    }

    /* Animated Background */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background:
        radial-gradient(circle at 15% 20%, rgba(6, 182, 212, 0.08) 0%, transparent 50%),
        radial-gradient(circle at 85% 80%, rgba(251, 191, 36, 0.06) 0%, transparent 50%),
        radial-gradient(circle at 50% 50%, rgba(16, 185, 129, 0.04) 0%, transparent 60%),
        radial-gradient(circle at 30% 70%, rgba(6, 182, 212, 0.05) 0%, transparent 40%);
      animation: backgroundFloat 20s ease-in-out infinite;
      pointer-events: none;
      z-index: -1;
    }

    @keyframes backgroundFloat {

      0%,
      100% {
        transform: translateY(0) rotate(0deg) scale(1);
      }

      25% {
        transform: translateY(-20px) rotate(1deg) scale(1.02);
      }

      50% {
        transform: translateY(10px) rotate(-1deg) scale(0.98);
      }

      75% {
        transform: translateY(-15px) rotate(0.5deg) scale(1.01);
      }
    }

    /* Container & Layout */
    .container {
      max-width: 2600px;
      margin: 0 auto;
      padding: 32px;
      min-height: 100vh;
      position: relative;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 32px;
      margin-bottom: 32px;
    }

    @media (max-width: 1200px) {
      .grid {
        grid-template-columns: 1fr;
        gap: 24px;
      }

      .container {
        padding: 20px;
      }
    }

    /* Luxurious Header */
    .hero {
      background: var(--surface-glass-1);
      backdrop-filter: blur(24px);
      border: 1px solid var(--border-medium);
      border-radius: var(--radius-2xl);
      padding: 48px 40px;
      margin-bottom: 40px;
      box-shadow: var(--shadow-floating), var(--shadow-inner), var(--shadow-glow-blue);
      position: relative;
      overflow: hidden;
      transition: var(--transition-smooth);
    }

    .hero::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: var(--accent-gradient);
      opacity: 0.03;
      transform: rotate(-45deg);
      pointer-events: none;
    }

    .hero::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, transparent 0%, rgba(6, 182, 212, 0.05) 50%, transparent 100%);
      pointer-events: none;
    }

    .hero:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-floating), var(--shadow-inner), var(--shadow-glow-blue);
    }

    .hero-content {
      position: relative;
      z-index: 2;
      text-align: center;
    }

    .hero h1 {
      margin: 0 0 20px;
      font-size: clamp(36px, 5vw, 56px);
      font-weight: 900;
      background: var(--accent-gradient);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      letter-spacing: -0.025em;
      line-height: 1.1;
      text-shadow: 0 0 40px rgba(6, 182, 212, 0.3);
    }

    .hero-subtitle {
      margin: 0;
      color: var(--text-secondary);
      font-size: clamp(16px, 2.5vw, 22px);
      font-weight: 500;
      line-height: 1.6;
      max-width: 800px;
      margin: 0 auto;
      opacity: 0.9;
    }

    /* Premium Cards */
    .card {
      background: var(--surface-glass-2);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-xl);
      padding: 36px 32px;
      box-shadow: var(--shadow-elevated), var(--shadow-inner);
      position: relative;
      overflow: hidden;
      transition: var(--transition-smooth);
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--accent-gradient);
      opacity: 0.6;
    }

    .card:hover {
      transform: translateY(-6px);
      box-shadow: var(--shadow-floating), var(--shadow-inner), var(--shadow-glow-blue);
      border-color: var(--border-accent);
    }

    .card:hover::before {
      opacity: 1;
      box-shadow: var(--shadow-glow-blue);
    }

    .card h2 {
      margin: 0 0 28px;
      font-size: clamp(24px, 3vw, 32px);
      font-weight: 800;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 16px;
      position: relative;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      position: relative;
    }

    .form-group.focused label {
      color: var(--accent-primary);
      transform: translateY(-2px);
    }


    input::placeholder {
      color: var(--text-faded);
      font-weight: 400;
    }

    input:focus {
      outline: none;
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 4px var(--accent-glow), var(--shadow-inner);
      background: rgba(6, 182, 212, 0.05);
      transform: translateY(-1px);
    }

    input:hover:not(:focus) {
      border-color: var(--border-medium);
      transform: translateY(-1px);
    }

    input[type="checkbox"] {
      width: 24px;
      height: 24px;
      border-radius: 8px;
      appearance: none;
      border: 2px solid var(--border-medium);
      background: var(--bg-elevated);
      cursor: pointer;
      position: relative;
      transition: var(--transition-smooth);
    }

    input[type="checkbox"]:checked {
      background: var(--accent-gradient);
      border-color: var(--accent-primary);
      box-shadow: var(--shadow-glow-blue);
    }

    input[type="checkbox"]:checked::after {
      content: '✓';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 1rem;
      font-weight: 700;
    }

    /* Stunning Buttons */
    .btn {
      appearance: none;
      border: none;
      cursor: pointer;
      padding: 16px 32px;
      border-radius: var(--radius-lg);
      font-family: inherit;
      font-size: 1rem;
      font-weight: 700;
      letter-spacing: 0.025em;
      transition: var(--transition-smooth);
      position: relative;
      overflow: hidden;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      min-height: 56px;
      text-transform: uppercase;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: var(--transition-slow);
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn-primary {
      background: var(--accent-gradient);
      color: white;
      box-shadow: var(--shadow-elevated), var(--shadow-glow-blue);
      border: 1px solid var(--accent-primary);
    }

    .btn-primary:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: var(--shadow-floating), var(--shadow-glow-blue);
    }

    .btn-primary:active {
      transform: translateY(-1px) scale(1.01);
    }

    .btn-secondary {
      background: var(--surface-glass-3);
      backdrop-filter: blur(10px);
      color: var(--text-primary);
      border: 1px solid var(--border-medium);
      box-shadow: var(--shadow-elevated);
    }

    .btn-secondary:hover {
      border-color: var(--border-strong);
      box-shadow: var(--shadow-floating);
      transform: translateY(-2px);
    }

    .btn-danger {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 50%, #b91c1c 100%);
      color: white;
      box-shadow: var(--shadow-elevated), var(--danger-glow);
      border: 1px solid #ef4444;
    }

    .btn-danger:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: var(--shadow-floating), 0 0 40px rgba(239, 68, 68, 0.3);
    }

    .btn-full {
      width: 100%;
    }

    /* Elegant Toolbar */
    .toolbar {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
      align-items: center;
    }

    @media (max-width: 640px) {
      .toolbar {
        flex-direction: column;
      }

      .btn {
        width: 100%;
      }
    }

    /* Premium KPI Cards */
    .summary {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin: 32px 0;
    }

    @media (max-width: 640px) {
      .summary {
        grid-template-columns: 1fr;
        gap: 16px;
      }
    }



    .success {
      background: var(--gold-gradient);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .warning {
      color: var(--warning);
    }

    .danger {
      color: var(--danger);
    }

    /* Sophisticated Table */
    .table-container {
      background: var(--surface-glass-3);
      backdrop-filter: blur(15px);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-lg);
      overflow: hidden;
      box-shadow: var(--shadow-elevated);
      margin: 24px 0;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th,
    td {
      padding: 20px 16px;
      text-align: center;
      border-bottom: 1px solid var(--border-subtle);
    }

    th {
      background: var(--surface-glass-1);
      backdrop-filter: blur(20px);
      color: var(--text-primary);
      font-weight: 800;
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      position: relative;
    }

    th::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--accent-gradient);
      opacity: 0.6;
    }

    td {
      font-size: 15px;
      color: var(--text-secondary);
      font-weight: 500;
    }

    tbody tr {
      transition: var(--transition-quick);
    }

    tbody tr:hover {
      background: rgba(6, 182, 212, 0.08);
      transform: translateX(4px);
    }

    tbody tr:last-child td {
      border-bottom: none;
    }

    /* Premium Chart */
    .chart-container {
      background: var(--surface-glass-2);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-medium);
      border-radius: var(--radius-xl);
      padding: 40px 36px;
      margin-top: 32px;
      box-shadow: var(--shadow-floating), var(--shadow-inner);
      position: relative;
      overflow: hidden;
    }

    .chart-container::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(6, 182, 212, 0.03) 0%, transparent 70%);
      pointer-events: none;
    }

    .chart-title {
      margin: 0 0 32px;
      color: var(--text-primary);
      font-weight: 800;
      font-size: 1.5rem;
      text-align: center;
      background: var(--accent-gradient);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    #savingsChart {
      display: block;
      width: 100% !important;
      height: 600px !important;
      border-radius: var(--radius-lg);
      position: relative;
      z-index: 1;
    }

    /* Status Messages */
    .status-message {
      padding: 20px 24px;
      border-radius: var(--radius-lg);
      margin: 20px 0;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 16px;
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow-ambient);
    }

    .status-warning {
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.15), rgba(217, 119, 6, 0.1));
      color: var(--warning);
      border: 1px solid rgba(245, 158, 11, 0.3);
    }

    .status-info {
      background: linear-gradient(135deg, rgba(6, 182, 212, 0.15), rgba(14, 165, 233, 0.1));
      color: var(--accent-primary);
      border: 1px solid var(--border-accent);
    }

    /* Elegant Empty State */
    .empty-state {
      text-align: center;
      padding: 60px 30px;
      border: 2px dashed var(--border-medium);
      border-radius: var(--radius-lg);
      background: rgb(13 13 35 / 70%);
      backdrop-filter: blur(10px);
      transition: var(--transition-smooth);
    }

    .empty-state:hover {
      border-color: var(--border-accent);
      background: rgba(6, 182, 212, 0.05);
    }

    .empty-state-icon {
      font-size: 4rem;
      margin-bottom: 24px;
      background: var(--accent-gradient);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      opacity: 0.7;
    }

    .empty-state-text {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--text-muted);
      line-height: 1.6;
    }

    /* Premium Settings Panel */
    .settings-panel {
      background: var(--surface-glass-3);
      backdrop-filter: blur(15px);
      border: 1px solid var(--border-medium);
      border-radius: var(--radius-lg);
      padding: 28px;
      margin: 24px 0;
      box-shadow: var(--shadow-elevated), var(--shadow-inner);
    }

    .settings-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border-subtle);
    }

    .settings-title {
      font-weight: 800;
      color: var(--text-primary);
      font-size: 1.2rem;
      background: var(--accent-gradient);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    /* Info Note */
    .info-note {
      font-size: 1rem;
      color: deepskyblue;
      margin-top: 12px;
      padding: 16px 20px;
      background: var(--surface-glass-3);
      backdrop-filter: blur(10px);
      border-radius: var(--radius);
      border: 1px solid var(--border-accent);
      box-shadow: var(--shadow-glow-blue);
    }

    /* Advanced Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(30px);
      }

      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes glow {

      0%,
      100% {
        box-shadow: var(--shadow-elevated), var(--shadow-glow-blue);
      }

      50% {
        box-shadow: var(--shadow-floating), 0 0 60px rgba(6, 182, 212, 0.4);
      }
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
        transform: scale(1);
      }

      50% {
        opacity: 0.8;
        transform: scale(1.02);
      }
    }

    @keyframes shimmer {
      0% {
        transform: translateX(-100%);
      }

      100% {
        transform: translateX(100%);
      }
    }

    .animate-in {
      animation: fadeInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }

    .animate-slide {
      animation: slideInRight 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }

    .animate-glow {
      animation: glow 3s ease-in-out infinite;
    }

    /* Loading State */
    .loading {
      animation: pulse 2s infinite;
      position: relative;
    }

    .loading::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(6, 182, 212, 0.2), transparent);
      animation: shimmer 2s infinite;
    }

    /* Responsive Enhancements */
    @media (max-width: 768px) {
      .hero {
        padding: 32px 24px;
      }

      .card {
        padding: 24px 20px;
      }

      .form-row {
        gap: 16px;
      }

      .btn {
        padding: 14px 20px;
        font-size: 15px;
        min-height: 50px;
      }

      .kpi {
        padding: 20px 16px;
      }

      .goal-item {
        padding: 20px;
      }

      .chart-container {
        padding: 24px 20px;
      }

      #savingsChart {
        height: 350px !important;
      }
    }

    @media (max-width: 480px) {
      .container {
        padding: 16px;
      }

      .hero {
        padding: 24px 16px;
      }

      .card {
        padding: 20px 16px;
      }

      .goal-meta {
        grid-template-columns: 1fr;
      }
    }

    /* Custom Scrollbar */
    ::-webkit-scrollbar {
      width: 12px;
    }

    ::-webkit-scrollbar-track {
      background: var(--bg-secondary);
      border-radius: 6px;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--accent-gradient);
      border-radius: 6px;
      border: 2px solid var(--bg-secondary);
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--gold-gradient);
      box-shadow: var(--shadow-glow-gold);
    }

    /* Selection Styling */
    ::selection {
      background: rgba(6, 182, 212, 0.3);
      color: var(--text-primary);
    }

    ::-moz-selection {
      background: rgba(6, 182, 212, 0.3);
      color: var(--text-primary);
    }

    /* Focus Ring Enhancement */
    *:focus {
      outline: 2px solid var(--accent-primary);
      outline-offset: 2px;
    }

    /* Enhanced Button States */
    .btn.success {
      background: var(--gold-gradient);
      color: white;
      box-shadow: var(--shadow-elevated), var(--shadow-glow-gold);
    }

    .btn.success:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: var(--shadow-floating), 0 0 50px rgba(251, 191, 36, 0.4);
    }

    /* Particle Effect for Premium Feel */
    .particle-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
      opacity: 0.1;
    }

    .particle {
      position: absolute;
      width: 2px;
      height: 2px;
      background: var(--accent-primary);
      border-radius: 50%;
      animation: float 20s linear infinite;
    }

    @keyframes float {
      0% {
        transform: translateY(100vh) translateX(0);
        opacity: 0;
      }

      10% {
        opacity: 1;
      }

      90% {
        opacity: 1;
      }

      100% {
        transform: translateY(-100px) translateX(100px);
        opacity: 0;
      }
    }

    /* Luxury Touch - Gradient Text Effects */
    .gradient-text-primary {
      background: var(--accent-gradient);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .gradient-text-gold {
      background: var(--gold-gradient);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    /* Advanced Glass Effects */
    .glass-intense {
      background: rgb(13 13 35 / 70%);
      backdrop-filter: blur(30px) saturate(180%);
      border: 1px solid rgba(255, 255, 255, 0.18);
    }

    .glass-subtle {
      background: rgba(20, 20, 25, 0.4);
      backdrop-filter: blur(20px) saturate(150%);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    /* Micro-interactions */
    .interactive:hover {
      cursor: pointer;
    }

    .interactive:active {
      transform: scale(0.98);
    }

    /* Premium Tooltips */
    [data-tooltip] {
      position: relative;
    }

    [data-tooltip]:hover::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      padding: 8px 12px;
      background: var(--surface-glass-1);
      backdrop-filter: blur(20px);
      color: var(--text-primary);
      font-size: 12px;
      font-weight: 500;
      border-radius: var(--radius);
      border: 1px solid var(--border-accent);
      box-shadow: var(--shadow-floating);
      white-space: nowrap;
      z-index: 1000;
      animation: fadeInUp 0.2s ease;
    }

    /* Bonus Section Styling */
    .bonus-section {
      background: var(--surface-glass-3);
      border-radius: var(--radius);
      padding: 16px;
      margin: 16px 0;
      border: 1px solid var(--border-subtle);
    }

    .bonus-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 12px;
      background: rgba(6, 182, 212, 0.1);
      border-radius: var(--radius-sm);
      margin: 8px 0;
    }

    .bonus-item button {
      background: var(--danger);
      border: none;
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      cursor: pointer;
    }

    /* Sensitivity Analysis */
    .sensitivity-controls {
      padding: 16px 0;
    }

    .sensitivity-controls label {
      display: block;
      margin-bottom: 12px;
      font-weight: 600;
    }

    .sensitivity-controls input[type="range"] {
      width: 100%;
      margin-bottom: 16px;
    }

    #sensitivityResults {
      background: var(--bg-elevated);
      border-radius: var(--radius);
      padding: 12px;
      max-height: 200px;
      overflow-y: auto;
    }

    .sensitivity-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid var(--border-subtle);
    }

    .time-change.positive {
      color: var(--success);
    }

    .time-change.negative {
      color: var(--danger);
    }

    /* Warnings System */
    .warnings-container {
      margin: 20px 0;
    }

    .warning-item {
      padding: 16px;
      border-radius: var(--radius);
      margin: 12px 0;
      border-left: 4px solid;
    }

    .warning-item.danger {
      background: var(--danger-glow);
      border-left-color: var(--danger);
      color: #fca5a5;
    }

    .warning-item.warning {
      background: var(--warning-glow);
      border-left-color: var(--warning);
      color: #fbbf24;
    }

    .warning-item.info {
      background: rgba(6, 182, 212, 0.1);
      border-left-color: var(--accent-primary);
      color: #93c5fd;
    }

    .warning-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
      font-weight: 700;
    }

    .warning-message {
      margin-bottom: 8px;
      opacity: 0.9;
    }

    .warning-suggestion {
      font-size: 0.9em;
      opacity: 0.8;
      font-style: italic;
    }

    .success-message {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px;
      background: var(--success-glow);
      color: var(--success);
      border-radius: var(--radius);
      border-left: 4px solid var(--success);
    }

    /* Time Savings Badge */
    .time-saved-badge {
      background: var(--gold-gradient);
      color: white;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 0.8rem;
      font-weight: 600;
      margin-top: 8px;
      display: inline-block;
    }

    /* Select Styling */
    select {
      width: 100%;
      padding: 16px 20px;
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-lg);
      background: var(--surface-glass-3);
      backdrop-filter: blur(15px);
      color: var(--text-primary);
      font-weight: 500;
      transition: var(--transition-smooth);
      box-shadow: var(--shadow-inner);
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      cursor: pointer;
      background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23ffffff'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: left 16px center;
      padding-left: 50px;
    }

    select:focus {
      outline: none;
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 4px var(--accent-glow), var(--shadow-inner);
      background: rgba(6, 182, 212, 0.05);
      transform: translateY(-1px);
    }

    select:hover:not(:focus) {
      border-color: var(--border-medium);
      transform: translateY(-1px);
    }

    select option {
      background: var(--bg-card);
      color: var(--text-primary);
      padding: 12px 16px;
      border: none;
      font-weight: 500;
    }

    select option:checked,
    select option:hover {
      background: var(--accent-primary);
      color: white;
    }

    /* Firefox specific styling */
    @-moz-document url-prefix() {
      select {
        background-image: none;
        padding-left: 20px;
      }
    }

    .modal.hidden {
      display: none !important;
    }

    /* CSS מתוקן לכפתורי זום - נוסף במקום הנכון */
    .zoom-controls {
      position: absolute;
      top: 15px;
      left: 15px;
      z-index: 1000;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .zoom-btn {
      width: 40px;
      height: 40px;
      border: none;
      border-radius: 8px;
      background: rgba(20, 20, 25, 0.9);
      backdrop-filter: blur(10px);
      color: #ffffff;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .zoom-btn:hover {
      background: rgba(6, 182, 212, 0.3);
      border-color: rgba(6, 182, 212, 0.6);
      transform: scale(1.1);
    }

    .zoom-btn.active {
      background: rgba(6, 182, 212, 0.5);
      border-color: rgba(6, 182, 212, 0.8);
      color: #ffffff;
    }

    :root {
      /* Sophisticated Dark Palette */
      --bg-primary: #050507;
      --bg-secondary: #0a0a0d;
      --bg-tertiary: #0f0f14;
      --bg-card: #141419;
      --bg-elevated: #1a1a20;
      --bg-glass: rgba(20, 20, 25, 0.8);
      --bg-gradient: linear-gradient(135deg, #050507 0%, #0a0a0d 30%, #0f0f14 100%);

      /* Glass Morphism */
      --surface-glass-1: linear-gradient(135deg, rgba(20, 20, 25, 0.95) 0%, rgba(26, 26, 32, 0.9) 100%);
      --surface-glass-2: linear-gradient(135deg, rgba(26, 26, 32, 0.9) 0%, rgba(35, 35, 42, 0.85) 100%);
      --surface-glass-3: linear-gradient(135deg, rgba(35, 35, 42, 0.85) 0%, rgba(45, 45, 54, 0.8) 100%);

      /* Premium Text */
      --text-primary: #ffffff;
      --text-secondary: #e2e8f0;
      --text-muted: #cbd5e1;
      --text-dim: #94a3b8;
      --text-faded: #64748b;

      /* Luxurious Brand Colors */
      --accent-primary: #06b6d4;
      --accent-secondary: #0891b2;
      --accent-gradient: linear-gradient(135deg, #06b6d4 0%, #0891b2 50%, #0e7490 100%);
      --accent-glow: rgba(6, 182, 212, 0.4);

      /* Premium Gold Accent */
      --gold-primary: #fbbf24;
      --gold-secondary: #f59e0b;
      --gold-gradient: linear-gradient(135deg, #fbbf24 0%, #f59e0b 50%, #d97706 100%);
      --gold-glow: rgba(251, 191, 36, 0.3);

      /* Status Colors */
      --success: #10b981;
      --success-glow: rgba(16, 185, 129, 0.2);
      --warning: #f59e0b;
      --warning-glow: rgba(245, 158, 11, 0.2);
      --danger: #ef4444;
      --danger-glow: rgba(239, 68, 68, 0.2);

      /* Advanced Shadows & Effects */
      --shadow-ambient: 0 4px 24px rgba(0, 0, 0, 0.3);
      --shadow-elevated: 0 8px 40px rgba(0, 0, 0, 0.4);
      --shadow-floating: 0 16px 64px rgba(0, 0, 0, 0.5);
      --shadow-glow-blue: 0 0 40px rgba(6, 182, 212, 0.15);
      --shadow-glow-gold: 0 0 40px rgba(251, 191, 36, 0.15);
      --shadow-inner: inset 0 1px 0 rgba(255, 255, 255, 0.1);
      --shadow-depth: inset 0 -1px 0 rgba(0, 0, 0, 0.2);

      /* Borders */
      --border-subtle: rgba(255, 255, 255, 0.06);
      --border-medium: rgba(255, 255, 255, 0.12);
      --border-strong: rgba(255, 255, 255, 0.18);
      --border-accent: rgba(6, 182, 212, 0.4);
      --border-gold: rgba(251, 191, 36, 0.4);

      /* Radius */
      --radius-sm: 8px;
      --radius: 16px;
      --radius-lg: 24px;
      --radius-xl: 32px;
      --radius-2xl: 40px;

      /* Animation */
      --transition-quick: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html,
    body {
      height: 100%;
      overflow-x: hidden;
    }

    body {
      font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg-gradient);
      background-attachment: fixed;
      color: var(--text-primary);
      line-height: 1.7;
      font-size: 18px;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      position: relative;
    }

    /* Animated Background */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background:
        radial-gradient(circle at 15% 20%, rgba(6, 182, 212, 0.08) 0%, transparent 50%),
        radial-gradient(circle at 85% 80%, rgba(251, 191, 36, 0.06) 0%, transparent 50%),
        radial-gradient(circle at 50% 50%, rgba(16, 185, 129, 0.04) 0%, transparent 60%),
        radial-gradient(circle at 30% 70%, rgba(6, 182, 212, 0.05) 0%, transparent 40%);
      animation: backgroundFloat 20s ease-in-out infinite;
      pointer-events: none;
      z-index: -1;
    }

    @keyframes backgroundFloat {

      0%,
      100% {
        transform: translateY(0) rotate(0deg) scale(1);
      }

      25% {
        transform: translateY(-20px) rotate(1deg) scale(1.02);
      }

      50% {
        transform: translateY(10px) rotate(-1deg) scale(0.98);
      }

      75% {
        transform: translateY(-15px) rotate(0.5deg) scale(1.01);
      }
    }


    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 32px;
      margin-bottom: 32px;
    }

    @media (max-width: 1200px) {
      .grid {
        grid-template-columns: 1fr;
        gap: 24px;
      }

      .container {
        padding: 20px;
      }
    }

    /* Luxurious Header */
    .hero {
      background: var(--surface-glass-1);
      backdrop-filter: blur(24px);
      border: 1px solid var(--border-medium);
      border-radius: var(--radius-2xl);
      padding: 48px 40px;
      margin-bottom: 40px;
      box-shadow: var(--shadow-floating), var(--shadow-inner), var(--shadow-glow-blue);
      position: relative;
      overflow: hidden;
      transition: var(--transition-smooth);
    }

    .hero::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: var(--accent-gradient);
      opacity: 0.03;
      transform: rotate(-45deg);
      pointer-events: none;
    }

    .hero::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, transparent 0%, rgba(6, 182, 212, 0.05) 50%, transparent 100%);
      pointer-events: none;
    }

    .hero:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-floating), var(--shadow-inner), var(--shadow-glow-blue);
    }

    .hero-content {
      position: relative;
      z-index: 2;
      text-align: center;
    }

    .hero h1 {
      margin: 0 0 20px;
      font-size: clamp(36px, 5vw, 56px);
      font-weight: 900;
      background: var(--accent-gradient);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      letter-spacing: -0.025em;
      line-height: 1.1;
      text-shadow: 0 0 40px rgba(6, 182, 212, 0.3);
    }

    .hero-subtitle {
      margin: 0;
      color: var(--text-secondary);
      font-size: clamp(16px, 2.5vw, 22px);
      font-weight: 500;
      line-height: 1.6;
      max-width: 800px;
      margin: 0 auto;
      opacity: 0.9;
    }

    /* Premium Cards */
    .card {
      background: var(--surface-glass-2);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-xl);
      padding: 36px 32px;
      box-shadow: var(--shadow-elevated), var(--shadow-inner);
      position: relative;
      overflow: hidden;
      transition: var(--transition-smooth);
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--accent-gradient);
      opacity: 0.6;
    }

    .card:hover {
      transform: translateY(-6px);
      box-shadow: var(--shadow-floating), var(--shadow-inner), var(--shadow-glow-blue);
      border-color: var(--border-accent);
    }

    .card:hover::before {
      opacity: 1;
      box-shadow: var(--shadow-glow-blue);
    }

    .card h2 {
      margin: 0 0 28px;
      font-size: clamp(24px, 3vw, 32px);
      font-weight: 800;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 16px;
      position: relative;
    }

    .card-icon {
      font-size: 2rem;
      background: var(--accent-gradient);
      background-clip: text;
      -webkit-background-clip: text;
      filter: drop-shadow(0 0 10px rgba(6, 182, 212, 0.3));
    }

    /* Sophisticated Form Elements */
    .form-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 24px;
      margin-bottom: 28px;
    }

    @media (max-width: 768px) {
      .form-row {
        grid-template-columns: 1fr;
        gap: 16px;
      }
    }

    label {
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--text-muted);
      margin-bottom: 12px;
      letter-spacing: 0.02em;
      text-transform: uppercase;
      transition: var(--transition-quick);
    }

    input[type="text"],
    input[type="number"],
    input[type="date"] {
      width: 100%;
      padding: 16px 20px;
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-lg);
      background: var(--surface-glass-3);
      backdrop-filter: blur(10px);
      color: var(--text-primary);
      font-weight: 900;
	  font-size: larger;
	  text-align: center;
      transition: var(--transition-smooth);
      box-shadow: var(--shadow-inner);
    }

    input::placeholder {
      color: var(--text-faded);
      font-weight: 400;
    }

    input:focus {
      outline: none;
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 4px var(--accent-glow), var(--shadow-inner);
      background: rgba(6, 182, 212, 0.05);
      transform: translateY(-1px);
    }

    input:hover:not(:focus) {
      border-color: var(--border-medium);
      transform: translateY(-1px);
    }

    /* Premium Checkbox */
    .checkbox-container {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 16px;
      background: var(--surface-glass-3);
      border-radius: var(--radius);
      border: 1px solid var(--border-subtle);
    }

    input[type="checkbox"] {
      width: 24px;
      height: 24px;
      border-radius: 8px;
      appearance: none;
      border: 2px solid var(--border-medium);
      background: var(--bg-elevated);
      cursor: pointer;
      position: relative;
      transition: var(--transition-smooth);
    }

    input[type="checkbox"]:checked {
      background: var(--accent-gradient);
      border-color: var(--accent-primary);
      box-shadow: var(--shadow-glow-blue);
    }

    input[type="checkbox"]:checked::after {
      content: '✓';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 1rem;
      font-weight: 700;
    }

    /* Stunning Buttons */
    .btn {
      appearance: none;
      border: none;
      cursor: pointer;
      padding: 16px 32px;
      border-radius: var(--radius-lg);
      font-family: inherit;
      font-size: 1rem;
      font-weight: 700;
      letter-spacing: 0.025em;
      transition: var(--transition-smooth);
      position: relative;
      overflow: hidden;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      min-height: 56px;
      text-transform: uppercase;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: var(--transition-slow);
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn-primary {
      background: var(--accent-gradient);
      color: white;
      box-shadow: var(--shadow-elevated), var(--shadow-glow-blue);
      border: 1px solid var(--accent-primary);
    }

    .btn-primary:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: var(--shadow-floating), var(--shadow-glow-blue);
    }

    .btn-primary:active {
      transform: translateY(-1px) scale(1.01);
    }

    .btn-secondary {
      background: var(--surface-glass-3);
      backdrop-filter: blur(10px);
      color: var(--text-primary);
      border: 1px solid var(--border-medium);
      box-shadow: var(--shadow-elevated);
    }

    .btn-secondary:hover {
      border-color: var(--border-strong);
      box-shadow: var(--shadow-floating);
      transform: translateY(-2px);
    }

    .btn-danger {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 50%, #b91c1c 100%);
      color: white;
      box-shadow: var(--shadow-elevated), var(--danger-glow);
      border: 1px solid #ef4444;
    }

    .btn-danger:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: var(--shadow-floating), 0 0 40px rgba(239, 68, 68, 0.3);
    }

    .btn-full {
      width: 100%;
    }

    /* Elegant Toolbar */
    .toolbar {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
      align-items: center;
    }

    @media (max-width: 640px) {
      .toolbar {
        flex-direction: column;
      }

      .btn {
        width: 100%;
      }
    }

    /* Premium KPI Cards */
    .summary {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin: 32px 0;
    }

    @media (max-width: 640px) {
      .summary {
        grid-template-columns: 1fr;
        gap: 16px;
      }
    }

    .kpi {
      
      backdrop-filter: blur(15px);
      border: 1px solid var(--border-medium);
      border-radius: var(--radius-lg);
      padding: 28px 24px;
      text-align: center;
      box-shadow: var(--shadow-elevated), var(--shadow-inner);
      position: relative;
      overflow: hidden;
      transition: var(--transition-smooth);
    }

    .kpi::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      background: var(--gold-gradient);
      border-radius: var(--radius-lg);
      opacity: 0;
      z-index: -1;
      transition: var(--transition-smooth);
    }

    .kpi:hover {
      transform: translateY(-4px) scale(1.02);
      box-shadow: var(--shadow-floating), var(--shadow-inner), var(--shadow-glow-gold);
    }

    .kpi:hover::before {
      opacity: 0.1;
    }

    .kpi .label {
      color: var(--text-muted);
      font-size: 1rem;
      font-weight: 700;
      margin-bottom: 16px;
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .kpi .value {
      font-size: clamp(28px, 4vw, 40px);
      font-weight: 900;
      background: var(--gold-gradient);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      /*font-family: 'JetBrains Mono', monospace;*/
      letter-spacing: -0.02em;
      text-shadow: 0 0 20px rgba(251, 191, 36, 0.3);
    }

    /* Luxurious Goal Items */
    .goal-item {
      background: rgb(13 13 35 / 70%);
      backdrop-filter: blur(15px);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-lg);
      padding: 28px;
      margin: 16px 0;
      transition: var(--transition-smooth);
      position: relative;
      overflow: hidden;
    }

    .goal-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 2px;
      background: var(--accent-gradient);
      transition: var(--transition-slow);
    }

    .goal-item:hover {
      transform: translateX(8px) translateY(-2px);
      border-color: var(--border-accent);
      box-shadow: var(--shadow-elevated), var(--shadow-glow-blue);
    }

    .goal-item:hover::before {
      left: 0;
    }

    .goal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .goal-name {
      font-weight: 800;
      font-size: 1.4rem;
      color: var(--text-primary);
      background: var(--accent-gradient);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .goal-amount {
      font-weight: 900;
      font-size: 1.4rem;
      background: var(--gold-gradient);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      /*font-family: 'JetBrains Mono', monospace;*/
    }

    .goal-meta {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 16px;
      color: var(--text-secondary);
      font-size: 1rem;
      margin-bottom: 20px;
    }

    .goal-meta-item {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 10px;
      padding: 12px;
      background: rgba(6, 182, 212, 0.05);
      border-radius: var(--radius);
      border: 1px solid var(--border-subtle);
    }

    .goal-meta-label {
      font-size: 0.8rem;
      color: var(--text-faded);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 600;
    }

    .goal-meta-value {
      font-weight: 700;
      color: var(--text-primary);
    }

    .success {
      background: var(--gold-gradient);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .warning {
      color: var(--warning);
    }

    .danger {
      color: var(--danger);
    }

    /* Sophisticated Table */
    .table-container {
      background: var(--surface-glass-3);
      backdrop-filter: blur(15px);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-lg);
      overflow: hidden;
      box-shadow: var(--shadow-elevated);
      margin: 24px 0;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th,
    td {
      padding: 20px 16px;
      text-align: center;
      border-bottom: 1px solid var(--border-subtle);
    }

    th {
      background: var(--surface-glass-1);
      backdrop-filter: blur(20px);
      color: var(--text-primary);
      font-weight: 800;
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      position: relative;
    }

    th::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--accent-gradient);
      opacity: 0.6;
    }

    td {
      font-size: 15px;
      color: var(--text-secondary);
      font-weight: 500;
    }

    tbody tr {
      transition: var(--transition-quick);
    }

    tbody tr:hover {
      background: rgba(6, 182, 212, 0.08);
      transform: translateX(4px);
    }

    tbody tr:last-child td {
      border-bottom: none;
    }

    /* Premium Chart */
    .chart-container {
      background: rgb(13 13 35 / 70%);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-medium);
      border-radius: var(--radius-xl);
      padding: 40px 36px;
      margin-top: 32px;
      box-shadow: var(--shadow-floating), var(--shadow-inner);
      position: relative;
      overflow: hidden;
    }

    .chart-container::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(6, 182, 212, 0.03) 0%, transparent 70%);
      pointer-events: none;
    }

    .chart-title {
      margin: 0 0 32px;
      color: var(--text-primary);
      font-weight: 800;
      font-size: 1.5rem;
      text-align: center;
      background: var(--accent-gradient);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }


    /* Status Messages */
    .status-message {
      padding: 20px 24px;
      border-radius: var(--radius-lg);
      margin: 20px 0;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 16px;
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow-ambient);
    }

    .status-warning {
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.15), rgba(217, 119, 6, 0.1));
      color: var(--warning);
      border: 1px solid rgba(245, 158, 11, 0.3);
    }

    .status-info {
      background: linear-gradient(135deg, rgba(6, 182, 212, 0.15), rgba(14, 165, 233, 0.1));
      color: var(--accent-primary);
      border: 1px solid var(--border-accent);
    }

    /* Optimization Styling */
    .optimization-comparison {
      margin-top: 20px;
    }

    .before-after-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    @media (max-width: 768px) {
      .before-after-grid {
        grid-template-columns: 1fr;
      }
    }

    .optimization-column {
      background: var(--surface-glass-3);
      border-radius: var(--radius);
      padding: 16px;
      border: 1px solid var(--border-subtle);
    }

    .optimization-column h4 {
      color: var(--accent-primary);
      margin-bottom: 12px;
      font-size: 1.1rem;
    }

    .optimization-benefits {
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid rgba(16, 185, 129, 0.3);
      border-radius: var(--radius);
      padding: 16px;
      margin: 16px 0;
    }

    .optimization-benefits h4 {
      color: var(--success);
      margin-bottom: 12px;
    }

    .benefit-item {
      display: flex;
      align-items: center;
      gap: 8px;
      margin: 8px 0;
      padding: 8px;
      background: rgba(16, 185, 129, 0.05);
      border-radius: var(--radius-sm);
    }

    .benefit-icon {
      color: var(--success);
      font-weight: bold;
    }

    .optimization-actions {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin-top: 20px;
    }

    @media (max-width: 640px) {
      .optimization-actions {
        flex-direction: column;
      }
    }

    /* Smart Suggestions Styling */
    .suggestion-item {
      background: var(--surface-glass-3);
      border: 1px solid var(--border-accent);
      border-radius: var(--radius);
      padding: 16px;
      margin: 12px 0;
      transition: var(--transition-smooth);
    }

    .suggestion-item:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-elevated), var(--shadow-glow-blue);
    }

    .suggestion-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 8px;
    }

    .suggestion-icon {
      font-size: 1.5rem;
      background: var(--gold-gradient);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .suggestion-title {
      font-weight: 700;
      color: var(--text-primary);
    }

    .suggestion-description {
      color: var(--text-secondary);
      margin-bottom: 8px;
    }

    .suggestion-impact {
      color: var(--success);
      font-weight: 600;
      font-size: 0.9rem;
    }

    /* ROI Display */
    .roi-indicator {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 0.8rem;
      font-weight: 600;
    }

    /* Export Section */
    .export-loading {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      padding: 20px;
      color: var(--text-secondary);
    }

    .loading-spinner {
      width: 20px;
      height: 20px;
      border: 2px solid var(--border-subtle);
      border-top: 2px solid var(--accent-primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    .roi-guide-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 12px;
      margin-top: 15px;
    }

    .roi-tier {
      padding: 12px;
      border-radius: 8px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .roi-tier:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    /* ROI Colors - High Specificity Override */
    .roi-indicator.roi-poor,
    span.roi-indicator.roi-poor {
      background: rgba(239, 68, 68, 0.3) !important;
      color: #ef4444 !important;
      border: 1px solid #ef4444 !important;
    }

    .roi-indicator.roi-fair,
    span.roi-indicator.roi-fair {
      background: rgba(6, 182, 212, 0.3) !important;
      color: #06b6d4 !important;
      border: 1px solid #06b6d4 !important;
    }

    .roi-indicator.roi-good,
    span.roi-indicator.roi-good {
      background: rgba(245, 158, 11, 0.3) !important;
      color: #f59e0b !important;
      border: 1px solid #f59e0b !important;
    }

    .roi-indicator.roi-excellent,
    span.roi-indicator.roi-excellent {
      background: rgba(16, 185, 129, 0.3) !important;
      color: #10b981 !important;
      border: 1px solid #10b981 !important;
    }

    .roi-tips {
      margin-top: 16px;
      padding: 16px;
      background: rgba(6, 182, 212, 0.1);
      border-radius: 8px;
      border: 1px solid var(--border-accent);
    }

    .hint {
      color: var(--text-muted);
      font-size: 0.85rem;
      margin-top: 4px;
      display: block;
      font-style: italic;
    }

    .existing-capital-display {
      background: rgba(16, 185, 129, 0.1);
      padding: 12px;
      border-radius: 8px;
      align-self: end;
      border: 1px solid rgba(16, 185, 129, 0.3);
    }

    .existing-capital-display .capital-amount {
      color: var(--success);
      font-weight: 700;
      font-size: 1.1rem;
    }

    .existing-capital-display .completion-percentage {
      color: var(--success);
      font-weight: 600;
      font-size: 0.9rem;
    }

    #proofPanel {
      direction: rtl;
      background: rgba(255, 255, 255, .02);
      border-radius: 12px;
    }

    #proofPanel .katex {
      font-size: 1.12rem;
      line-height: 1.35;
    }

    .proof-grid {
      display: grid;
      gap: 14px;
    }

    .proof-box {
      border: 1px solid rgba(255, 255, 255, .08);
      border-radius: 10px;
      padding: 12px;
      background: rgba(0, 0, 0, .06);
    }

    .proof-params {
      display: grid;
      grid-template-columns: repeat(2, minmax(160px, 1fr));
      gap: 6px 12px;
      font: 500 0.92rem/1.35 system-ui, Segoe UI, Arial;
      opacity: .9;
    }

    .proof-params span b {
      opacity: .75;
    }

    :root {
      /* Warning (yellow) */
      --warn-bg: #fffbeb;
      /* amber-50 */
      --warn-border: #f59e0b;
      /* amber-500 */
      --warn-text: #92400e;
      /* amber-800 */


      /* Error (red) */
      --err-bg: #fef2f2;
      /* red-50 */
      --err-border: #ef4444;
      /* red-500 */
      --err-text: #7f1d1d;
      /* red-800 */


      /* Generic */
      --sysmsg-title: 600;
      --sysmsg-text: 500;
    }


    @media (prefers-color-scheme: dark) {
      :root {
        --info-bg: #062b23;
        --info-border: #34d399;
        --info-text: #a7f3d0;


        --warn-bg: #2b2306;
        --warn-border: #fbbf24;
        --warn-text: #fde68a;


        --err-bg: #2b0b0b;
        --err-border: #f87171;
        --err-text: #fecaca;
      }
    }


    .sysmsg {
      display: flex;
      gap: .9rem;
      align-items: flex-start;
      direction: rtl;
      font-family: var(--sysmsg-font);
      border-radius: var(--sysmsg-radius);
      padding: .9rem 1rem;
      border: 1px solid transparent;
      position: relative;
      box-shadow: var(--sysmsg-shadow);
      background: var(--info-bg);
      color: var(--info-text);
    }

    .sysmsg::before {
      content: "";
      position: absolute;
      inset: 0 0 0 auto;
      width: 6px;
      border-radius: var(--sysmsg-radius) 0 0 var(--sysmsg-radius);
      background: var(--info-border);
    }

    .sysmsg__icon {
      flex: 0 0 auto;
      display: grid;
      place-items: center;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      border: 2px solid currentColor;
      font-size: .85rem;
      margin-top: .15rem;
    }

    .sysmsg__body {
      flex: 1;
      min-width: 0;
    }

    .sysmsg__title {
      font-weight: var(--sysmsg-title);
      margin: 0 0 .2rem;
      line-height: 1.2;
    }

    .sysmsg__text {
      font-weight: var(--sysmsg-text);
      margin: 0;
      line-height: 1.45;
      opacity: .95;
    }

    .sysmsg__actions {
      display: flex;
      gap: .5rem;
      margin-top: .65rem;
      flex-wrap: wrap;
    }

    .sysmsg__btn {
      appearance: none;
      border: none;
      border-radius: 10px;
      padding: .4rem .7rem;
      font: 600 0.9rem var(--sysmsg-font);
      cursor: pointer;
      box-shadow: inset 0 0 0 2px currentColor;
      background: transparent;
    }

    .sysmsg__close {
      position: absolute;
      left: .35rem;
      top: .35rem;
      width: 34px;
      height: 34px;
      display: grid;
      place-items: center;
      border-radius: 10px;
      opacity: .75;
      cursor: pointer;
      border: none;
      background: transparent;
    }

    .sysmsg__close:hover {
      opacity: 1;
    }

    .sysmsg__progress {
      position: absolute;
      right: 6px;
      left: 6px;
      bottom: 6px;
      height: 4px;
      border-radius: 999px;
      overflow: hidden;
      background: rgba(0, 0, 0, .08);
    }

    .sysmsg__bar {
      height: 100%;
      width: 100%;
      transform-origin: right center;
    }


    /* Variants */
    .sysmsg--info {
      background: var(--info-bg);
      color: var(--info-text);
    }

    .sysmsg--info::before {
      background: var(--info-border);
    }

    .sysmsg--info .sysmsg__btn {
      color: var(--info-border);
    }

    .sysmsg--info .sysmsg__bar {
      background: var(--info-border);
    }


    .sysmsg--warn {
      background: var(--warn-bg);
      color: var(--warn-text);
    }

    .sysmsg--warn::before {
      background: var(--warn-border);
    }

    .sysmsg--warn .sysmsg__btn {
      color: var(--warn-border);
    }

    .sysmsg--warn .sysmsg__bar {
      background: var(--warn-border);
    }


    .sysmsg--error {
      background: var(--err-bg);
      color: var(--err-text);
    }

    .sysmsg--error::before {
      background: var(--err-border);
    }

    .sysmsg--error .sysmsg__btn {
      color: var(--err-border);
    }

    .sysmsg--error .sysmsg__bar {
      background: var(--err-border);
    }


    /* Toast container */
    .sysmsg-toasts {
      position: fixed;
      top: 14px;
      right: 14px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 9999;
      pointer-events: none;
    }

    .sysmsg-toasts .sysmsg {
      width: min(420px, calc(100vw - 28px));
      pointer-events: auto;
      animation: slideIn .2s ease-out;
    }

    @keyframes slideIn {
      from {
        transform: translateY(-8px);
        opacity: 0
      }

      to {
        transform: translateY(0);
        opacity: 1
      }
    }


    /* Inline helper (full width) */
    .sysmsg-inline {
      margin: .75rem 0;
    }

    input[data-format="money"] {
      direction: ltr;
      text-align: center;
    }

    /* Badge בסיסי */
    .roi-badge {
      display: inline-flex;
      align-items: center;
      gap: .4rem;
      padding: .2rem .5rem;
      border-radius: .5rem;
      font-size: clamp(28px, 4vw, 40px);
      font-weight: 900;
      font-variant-numeric: tabular-nums;
    }

    /* בהיר */
    .roi-bad {
      color: #7f1d1d;
      background: #fee2e2;
      border: 1px solid #fecaca;
    }

    /* אדום בהיר */
    .roi-weak {
      color: #78350f;
      background: #fef3c7;
      border: 1px solid #fde68a;
    }

    /* צהוב בהיר */
    .roi-ok {
      color: #1e3a8a;
      background: #dbeafe;
      border: 1px solid #bfdbfe;
    }

    /* כחול בהיר */
    .roi-good {
      color: #065f46;
      background: #d1fae5;
      border: 1px solid #a7f3d0;
    }

    /* ירוק בהיר */
    .roi-excellent {
      color: #064e3b;
      background: #a7f3d0;
      border: 1px solid #6ee7b7;
    }

    /* ירוק טורקיז */

    /* כהה (אם יש לך מנגנון מצב כהה, עדכן את הסלקטור לפי האתר: body.dark או [data-theme="dark"] וכו') */
    @media (prefers-color-scheme: dark) {
      .roi-bad {
        color: #fecaca;
        background: #450a0a;
        border-color: #7f1d1d;
      }

      .roi-weak {
        color: #fde68a;
        background: #422006;
        border-color: #854d0e;
      }

      .roi-ok {
        color: #bfdbfe;
        background: #0a2240;
        border-color: #1e3a8a;
      }

      .roi-good {
        color: #a7f3d0;
        background: #032a23;
        border-color: #065f46;
      }

      .roi-excellent {
        color: #6ee7b7;
        background: #05281f;
        border-color: #064e3b;
      }
    }

    /* Modal Base */
    .modal.hidden {
      display: none !important;
    }

    .modal {
      position: fixed;
      inset: 0;
      z-index: 2000;
      display: grid;
      place-items: center;
    }

    .modal-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, .55);
      backdrop-filter: blur(4px);
    }

    .modal-dialog {
      position: relative;
      z-index: 1;
      width: min(640px, 92vw);
      background: var(--surface-glass-2);
      border: 1px solid var(--border-medium);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-floating), var(--shadow-inner);
      animation: fadeInUp .25s ease;
    }

    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 18px 22px;
      border-bottom: 1px solid var(--border-subtle);
    }

    .modal-header h3 {
      margin: 0;
      font-size: 1.2rem;
      font-weight: 800;
      background: var(--accent-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .modal-close {
      background: transparent;
      border: 1px solid var(--border-medium);
      color: var(--text-primary);
      width: 36px;
      height: 36px;
      border-radius: 10px;
      font-size: 20px;
      cursor: pointer;
      transition: var(--transition-quick);
    }

    .modal-close:hover {
      border-color: var(--border-accent);
      box-shadow: var(--shadow-glow-blue);
    }

    .modal-body {
      padding: 22px;
    }

    .modal-actions {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
      margin-top: 6px;
    }

    .form-error {
      margin-top: 6px;
      color: #ef4444;
      font-weight: 700;
      min-height: 1.2em;
    }

    /* שמירה על עקביות RTL עם שדות מספריים LTR */
    #bonusAmountInput,
    #bonusMonthInput {
      direction: ltr;
      text-align: center;
    }

    .bonus-list {
      display: grid;
      gap: 8px;
      margin-top: 8px;
    }

    .bonus-empty {
      color: #94a3b8;
      font-size: .9rem;
      margin-top: 8px;
    }

    .bonus-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 12px;
      border: 1px solid var(--border-subtle, #e5e7eb);
      border-radius: 10px;
      background: var(--surface-glass-2, rgba(255, 255, 255, .7));
      backdrop-filter: blur(4px);
    }

    .bonus-main {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .bonus-month {
      font-weight: 700;
      opacity: .85;
    }

    .bonus-amount {
      font-variant-numeric: tabular-nums;
    }

    .bonus-desc {
      opacity: .75;
    }

    .bonus-actions {
      display: flex;
      gap: 6px;
    }

    .btn-ghost {
      border: 1px solid var(--border-medium, #d1d5db);
      background: transparent;
      padding: 6px 10px;
      border-radius: 8px;
      cursor: pointer;
    }

    .btn-ghost:hover {
      border-color: var(--border-accent, #60a5fa);
    }

    .btn-ghost.danger {
      border-color: #fecaca;
      color: #b91c1c;
    }

    .bonus-summary {
      margin-top: 4px;
      padding: 8px 12px;
      border-radius: 8px;
      background: var(--surface-glass-1, rgba(0, 0, 0, .03));
      font-weight: 600;
      display: flex;
      justify-content: space-between;
      gap: 8px;
    }
	
	.rule72-input {
	  font-weight: 700;
	  border: 2px solid var(--border, #e2e8f0);
	  border-radius: 10px;
	  padding: 10px 12px;
	  transition: border-color .2s ease, box-shadow .2s ease, color .2s ease;
	  background: #fff;
	  /* אופציונלי: מספרים משמאל לימין */
	  direction: ltr;
	  text-align: left;
	}

	/* מצבי צבע */
	.rule72--excellent { color: var(--success, #16a34a) !important; border-color: var(--success, #16a34a) !important;border: 3px solid !important; }
	.rule72--ok        { color: var(--warning, #f59e0b) !important; border-color: var(--warning, #f59e0b) !important;border: 3px solid !important;  }
	.rule72--weak      { color: var(--text-muted, #64748b) !important; border-color: var(--text-muted, #64748b) !important;border: 3px solid !important;  }
	.rule72--bad       { color: var(--danger, #ef4444) !important; border-color: var(--danger, #ef4444) !important;border: 3px solid !important;  }
	.rule72--na        { color: #94a3b8 !important; border-color: #cbd5e1 !important;border: 3px solid !important;  }

	#rateChangeDisplay { direction: ltr; unicode-bidi: plaintext; }
	
	/* ===== Bonus panel (RTL friendly) ===== */
	.bonus-panel{direction:rtl;display:flex;flex-direction:column;gap:12px}
	.bonus-toolbar{display:flex;align-items:center;justify-content:space-between;gap:12px}
	.bonus-toolbar .title{font-weight:700;color:var(--text-primary,#e5e7eb);font-size:1rem}
	.bonus-toolbar .btn{min-height:36px}

	.bonus-editor{background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.02));
	  border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:14px}
	.bonus-editor.hidden{display:none}

	.bonus-editor .row{display:grid;grid-template-columns:repeat(12,1fr);gap:12px;align-items:end}
	.bonus-editor .field{display:flex;flex-direction:column;gap:6px}
	.bonus-editor .field label{font-size:.85rem;color:var(--text-muted,#9ca3af)}
	.bonus-editor .field.sm{grid-column:span 2}
	.bonus-editor .field.md{grid-column:span 3}
	.bonus-editor .field.lg{grid-column:span 6}
	.bonus-editor .actions{grid-column:span 2;display:flex;gap:8px;justify-content:flex-start}

	@media (max-width:880px){
	  .bonus-editor .field.sm,.bonus-editor .field.md,.bonus-editor .field.lg,.bonus-editor .actions{grid-column:span 12}
	}

	.bonus-list{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
	.bonus-item{grid-column:span 12;display:grid;grid-template-columns:repeat(12,1fr);gap:12px;
	  align-items:center;padding:12px;border:1px solid rgba(255,255,255,.08);border-radius:12px;
	  background:rgba(255,255,255,.02)}
	.bonus-item .chip{grid-column:span 2;justify-self:start;font-weight:700;
	  background:rgba(6,182,212,.15);border:1px solid rgba(6,182,212,.35);color:#aef;
	  border-radius:999px;padding:6px 10px}
	.bonus-item .amount{grid-column:span 3;font-weight:800;color:var(--text-primary,#fff)}
	.bonus-item .desc{grid-column:span 5;color:var(--text-muted,#9ca3af);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
	.bonus-item .item-actions{grid-column:span 2;display:flex;gap:8px;justify-content:flex-start}
	.bonus-empty{opacity:.75;padding:8px 2px;color:var(--text-muted,#9ca3af)}

	@media (max-width:880px){
	  .bonus-item .chip,.bonus-item .amount,.bonus-item .desc,.bonus-item .item-actions{grid-column:span 12}
	  .bonus-item .item-actions{justify-content:flex-start}
	}

	/* עיצוב הכפתור */
	.mode-toggle-btn {
	  padding: 10px 22px;
	  border: none;
	  border-radius: 8px;
	  font-weight: bold;
	  font-size: 16px;
	  cursor: pointer;
	  color: #fff;
	  background: linear-gradient(135deg, #2563eb, #3b82f6); /* כחול */
	  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
	  transition: all 0.3s ease;
	}

	/* אפקט ריחוף */
	.mode-toggle-btn:hover {
	  transform: translateY(-2px);
	  box-shadow: 0 6px 16px rgba(0,0,0,0.3);
	  background: linear-gradient(135deg, #1d4ed8, #2563eb);
	}

	/* מצב "ערך עתידי" – ירוק */
	.mode-toggle-btn.future {
	  background: linear-gradient(135deg, #059669, #10b981);
	}

	.mode-toggle-btn.future:hover {
	  background: linear-gradient(135deg, #047857, #059669);
	}
	
	.opt-table {
	  width: 100%;
	  margin-top: 12px;
	  border-collapse: collapse;
	  font-size: 0.9rem;
	  background: rgba(0,0,0,0.3);
	  border-radius: 8px;
	  overflow: hidden;
	  opacity: 0;
	  transition: opacity 0.6s ease-in-out;
	}
	.opt-table th, .opt-table td {
	  padding: 8px 12px;
	  text-align: center;
	  border-bottom: 1px solid rgba(255,255,255,0.1);
	}
	.opt-table th {
	  background: rgba(255,255,255,0.05);
	  font-weight: 600;
	}
	.opt-table tr:last-child td {
	  border-bottom: none;
	}
	
	.opt-table.fade-in {
	  opacity: 1;
	}

	/* === Optimization Results Table === */
	.opt-table {
	  width: 100%;
	  border-collapse: collapse;
	  margin-top: 15px;
	  font-size: 0.95rem;
	  border-radius: 8px;
	  overflow: hidden;
	  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
	}

	.opt-table thead {
	  background: linear-gradient(90deg, #007bff, #0056b3);
	  color: #fff;
	  text-align: center;
	  font-weight: bold;
	}

	.opt-table th, .opt-table td {
	  padding: 10px 12px;
	  border-bottom: 1px solid rgba(0,0,0,0.1);
	  text-align: center;
	}

	.opt-table tbody tr:nth-child(odd) {
	  background-color: rgba(0,0,0,0.03);
	}

	.opt-table tbody tr:nth-child(even) {
	  background-color: rgba(0,0,0,0.06);
	}

	.opt-table tbody tr:hover {
	  background-color: rgba(0, 123, 255, 0.1);
	  transition: background-color 0.3s ease;
	}

	/* תא עם עודף */
	.opt-table td span[style*="color:lime"] {
	  font-weight: bold;
	  color: #28a745 !important;
	}

	/* תא עם חסר */
	.opt-table td span[style*="color:red"] {
	  font-weight: bold;
	  color: #dc3545 !important;
	}

	/* === Dark Mode === */
	@media (prefers-color-scheme: dark) {
	  .opt-table thead {
		background: linear-gradient(90deg, #3399ff, #004080);
	  }
	  .opt-table tbody tr:nth-child(odd) {
		background-color: rgba(255,255,255,0.05);
	  }
	  .opt-table tbody tr:nth-child(even) {
		background-color: rgba(255,255,255,0.08);
	  }
	  .opt-table th, .opt-table td {
		border-bottom: 1px solid rgba(255,255,255,0.1);
		color: #eee;
	  }
	  .opt-table tbody tr:hover {
		background-color: rgba(51,153,255,0.15);
	  }
	}

	.opt-table .summary-row { font-weight: 700; background: rgba(255,255,255,0.05); }
	.opt-table .summary-row.surplus { background: rgba(40,167,69,.18); color: #28a745; }
	.opt-table .summary-row.deficit { background: rgba(220,53,69,.18); color: #dc3545; }
	
	.opt-table td.time-saved {
	  background: rgba(40,167,69,0.15);
	  color: #28a745;
	  font-weight: bold;
	}

	.opt-table td.no-change {
	  background: rgba(255,255,255,0.05);
	  color: #aaa;
	}
	
	.opt-table .summary-time {
	  background: #123;   /* אותו רקע כמו surplus */
	}
	.opt-table .summary-time span {
	  font-weight: bold;
	}
	
	.opt-table .summary-time td {
	  background: #123;
	  font-weight: bold;
	  text-align: right;
	}
	.opt-table .summary-time span {
	  color: lime;
	}
	
	/* שורות סיכום כלליות */
	.opt-table .summary-row td {
	  font-weight: bold;
	  text-align: right;
	}

	/* מצב surplus – עודף */
	.opt-table .summary-row.surplus td {
	  background: rgba(40,167,69,.18);
	  color: #28a745;
	}

	/* מצב deficit – חוסר */
	.opt-table .summary-row.deficit td {
	  background: rgba(220,53,69,.18);
	  color: #dc3545;
	}

	/* מצב time – קיצור זמן */
	.opt-table .summary-row.summary-time td {
	  background: #123;
	  color: #28a745;
	  font-weight: bold;
	}
	
	/* שורת סיכום כללית */
.opt-table .summary-row {
  font-weight: 700;
  background: rgba(255,255,255,0.05);
}

/* מצב עודף */
.opt-table .summary-row.surplus {
  background: rgba(40,167,69,.18);
  color: #28a745;
}

/* מצב חסר */
.opt-table .summary-row.deficit {
  background: rgba(220,53,69,.18);
  color: #dc3545;
}

/* מצב קיצור זמן */
.opt-table .summary-row.time {
  background: rgba(0,123,255,.18);
  color: #3399ff;
}


 .mermaid {
      margin: 40px auto;
      max-width: 900px;
      //background: #1e1e1e;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.6);
    }




  </style>
</head>

<body>
  <!-- Particle Background -->
  <div class="particle-bg" id="particleBg"></div>

  <div id="report" class="container">
    <!-- Luxurious Header -->
    <header class="hero animate-in">
      <div class="hero-content">
        <h1>📊 מחשבון פיננסי אסטרטגי</h1>
        <p class="hero-subtitle">
          כלי מקצועי לניהול מטרות חיסכון ותכנון עתידי
        </p>
      </div>
    </header>

    <div class="grid">

      <section class="card animate-in">
        <h2><span class="card-icon">🎯</span>ניהול מטרות</h2>

        <!-- Add Goal Form -->
        <div class="settings-panel glass-intense">
			<form id="goalForm">
			  <div class="form-row">
				<div class="form-group">
				  <label for="goalName">שם המטרה</label>
				  <input type="text" id="goalName" placeholder="למשל: רכב חדש">
				</div>
				<div class="form-group">
				  <label for="calculationMode">מצב חישוב</label>
				  <select id="calculationMode" onchange="toggleCalculationMode()">
					<option value="standard">רגיל: סכום + תאריך ← חיסכון
					  חודשי</option>
					<option value="amount_payment">חישוב סכום: חיסכון חודשי +
					  תאריך ← סכום יעד</option>
					<option value="date_payment">חישוב תאריך: סכום + חיסכון חודשי
					  ← תאריך יעד</option>
				  </select>
				</div>
				<div class="form-group">
				  <label for="goalAmount">סכום יעד (₪)</label>
				  <input data-format="money"  type="text" inputmode="decimal" id="goalAmount" placeholder="100,000" min="1">
				</div>
				<div class="form-group" id="monthlyPaymentGroup" style="display: none;">
				  <label for="monthlyPayment">חיסכון חודשי (₪)</label>
				  <input data-format="money"  type="text" inputmode="decimal" id="monthlyPayment" placeholder="1,000"
					min="1">
				</div>
				<div class="form-group">
				  <label for="goalDate">תאריך יעד</label>
				  <input type="text" id="goalDate" placeholder="dd/mm/yyyy">
				</div>
				<div class="form-group">
				  <label for="goalRate">ריבית שנתית צפויה (%)</label>
				  <input type="number" id="goalRate" value="4.0" step="0.1" min="0" max="50">
				</div>
				<div class="form-group">
				  <label for="goalExistingCapital">הון קיים למטרה (₪)</label>
				  <input id="goalExistingCapital" type="text" inputmode="decimal" min="0" step="0.01" data-format="money"
					placeholder="0">
				  <small class="hint"
					style="color: var(--text-muted); font-size: 0.85rem; margin-top: 4px; display: block;">
					סכום שכבר קיים עבור המטרה. מקוזז מהיעד ומתחיל ממנו את
					הסימולציה.
				  </small>
				</div>
				<!-- סוג חיסכון -->
				<div class="form-row">
				  <div class="form-group">
					<label for="savingsType">סוג חיסכון</label>
					<select id="savingsType" >
					  <option value="fixed">סכום קבוע</option>
					  <option value="progressive">חיסכון הדרגתי</option>
					</select>
				  </div>
				  <div class="form-group" id="progressiveGroup" style="display:none">
					<label for="monthlyIncrease">עלייה חודשית (₪)</label>
					<input type="number" id="monthlyIncrease" data-format="money" placeholder="50" step="10" min="0">
				  </div>
				</div>

				<!-- בונוסים חד-פעמיים -->
				<div class="bonus-section" style="margin: 20px 0;">
				  <div class="form-group">
					<label>בונוסים חד-פעמיים (אופציונלי)</label>
					<button type="button" class="btn btn-secondary" id="openBonusModalBtn">+ הוסף בונוס</button>
					<div id="bonusList" class="bonus-list"></div>
				  </div>
				</div>

			  </div>
			  <button class="btn btn-primary btn-full animate-glow" id="addGoalBtn">
				➕ הוסף מטרה
			  </button>
			</Form>
        </div>

        <!-- Goals List -->
        <div id="goalsList">
          <div class="empty-state">
            <div class="empty-state-icon">📋</div>
            <div class="empty-state-text">טרם הוגדרו מטרות — הוסף/י את המטרה
              הראשונה שלך</div>
          </div>
        </div>
      </section>

      <!-- Results Section -->
      <section class="card animate-in">
        <h2><span class="card-icon">📊</span>תוכנית החיסכון</h2>

        <div class="summary">
          <div class="kpi glass-intense">
            <div class="label">סכום היעדים הכולל</div>
            <div class="value" id="totalAmount">₪0</div>
          </div>
          <div class="kpi glass-intense">
            <div class="label">חיסכון חודשי כולל</div>
            <div class="value" id="monthlySaving">₪0</div>
          </div>
          <div class="kpi glass-intense">
            <div class="label">רווח מריבית עד היעד</div>
            <div class="value" id="interestGainKpi">₪0</div>
          </div>
          <div class="kpi glass-intense">
            <div class="label">ROI ממוצע</div>
            <div id="averageROI" class="roi-badge stat-number">—</div>
          </div>
        </div>
		
		<div style="text-align:center; margin-bottom: 1rem;">
		  <button id="toggleModeBtn" class="mode-toggle-btn">
			מצב: חודשי
		  </button>
		</div>
		<canvas id="goalsPieChart" width="400" height="400"></canvas>

        <!-- Optimization Section -->
        <div class="settings-panel glass-intense" style="margin-top: 20px;">
          <div class="settings-header">
            <div class="settings-title">🎯 אופטימיזציה אוטומטית</div>
			<select id="optimizeModeToggle" class="btn btn-secondary" style="margin-inline-end:10px;">
			  <option value="surplus">💰 מקסימום רווח</option>
			  <option value="time">⏳ קיצור זמן יעד</option>
			</select>
            <button class="btn btn-primary" id="optimizeBtn">
              🔍 מצא פתרון אופטימלי
            </button>
          </div>
          <div id="optimizationResults" style="display: none;">
            <div class="optimization-comparison">
              <div class="before-after-grid">
                <div class="optimization-column">
                  <h4>המצב הנוכחי</h4>
                  <div id="currentPlan"></div>
                </div>
                <div class="optimization-column">
                  <h4>התוכנית המומלצת</h4>
                  <div id="optimizedPlan"></div>
                </div>
              </div>
              <div class="optimization-benefits">
                <h4>יתרונות התוכנית המומלצת:</h4>
                <div id="optimizationBenefits"></div>
              </div>
              <div id="optimizationBadges" style="margin:8px 0 14px 0;"></div>
              <div class="optimization-actions">
                <button id="applyOptimization" class="btn btn-secondary">
                  ✅ אמץ תוכנית מומלצת
                </button>
                <button id="hideOptimization" class="btn btn-secondary">
                  ❌ השאר כמו שזה
                </button>
              </div>
            </div>
          </div>
		  
		  <div class="settings-panel glass-intense">
  <h3 style="text-align:center;">🔍 לוגיקת האופטימיזציה</h3>
<div class="mermaid">

%%{init: {'theme':'dark', 'themeVariables': { 'edgeLabelBackground':'transparent'}}}%%
flowchart TD
    START([🎯 נקודת פתיחה<br/>תקציב חודשי + ריבית כללית]):::startNode
    
    START ==>|🚀 התחל תהליך| MODE{🔄 בחר מצב<br/>אופטימיזציה}:::mainDecision
    
    MODE ==>|⏱️ TIME MODE| TIME_CALC[⏳ חישוב יעד<br/>עם משך זמן<br/>מקסימלי]:::timeProcess
    MODE ==>|💎 SURPLUS MODE| SURPLUS_CALC[💰 חישוב יעד<br/>עם ריבית<br/>מקסימלית]:::surplusProcess
    
    TIME_CALC ==> TIME_CHECK{🎲 האם הריבית<br/>עדיפה על<br/>הריבית הכללית?}:::checkDecision
    SURPLUS_CALC ==> SURPLUS_CHECK{🎲 האם הריבית<br/>עדיפה על<br/>הריבית הכללית?}:::checkDecision
    
    TIME_CHECK ==>|✅ כן - עדיף| TIME_ALLOCATE[🎯 הקצאת עודף<br/>ליעד ארוך טווח<br/>⏰ משך זמן מקסימלי]:::successAction
    TIME_CHECK ==>|❌ לא - לא עדיף| GENERAL_FUND[💼 השאר ביתרה<br/>הכללית<br/>🏦 ללא הקצאה ספציפית]:::neutralAction
    
    SURPLUS_CHECK ==>|✅ כן - עדיף| SURPLUS_ALLOCATE[🎯 הקצאת עודף<br/>ליעד ריבית גבוהה<br/>💹 רווח מקסימלי]:::successAction
    SURPLUS_CHECK ==>|❌ לא - לא עדיף| GENERAL_FUND
    
    TIME_ALLOCATE ==> END([🏁 סיום תהליך<br/>✨ אופטימיזציה הושלמה]):::endNode
    SURPLUS_ALLOCATE ==> END
    GENERAL_FUND ==> END
    
    %% === STYLE DEFINITIONS - DARK MODE OPTIMIZED ===
    classDef startNode fill:#1a237e,stroke:#3f51b5,stroke-width:3px,color:#fff,font-weight:bold,font-size:16px,rx:20,ry:20
    classDef endNode fill:#1b5e20,stroke:#4caf50,stroke-width:3px,color:#fff,font-weight:bold,font-size:16px,rx:20,ry:20
    classDef mainDecision fill:#4a148c,stroke:#9c27b0,stroke-width:3px,color:#fff,font-weight:bold,font-size:15px
    classDef checkDecision fill:#01579b,stroke:#03a9f4,stroke-width:3px,color:#fff,font-weight:bold,font-size:14px
    classDef timeProcess fill:none,stroke:#2196f3,stroke-width:3px,color:#2196f3,font-weight:bold,font-size:14px
    classDef surplusProcess fill:none,stroke:#009688,stroke-width:3px,color:#009688,font-weight:bold,font-size:14px
    classDef successAction fill:none,stroke:#66bb6a,stroke-width:3px,color:#66bb6a,font-weight:bold,font-size:14px
    classDef neutralAction fill:none,stroke:#757575,stroke-width:3px,color:#757575,font-weight:bold,font-size:14px
</div>


</div>
        </div>

        <!-- Smart Suggestions -->
        <div class="settings-panel glass-intense" id="smartSuggestions" style="display: none;">
          <div class="settings-header">
            <div class="settings-title">💡 הצעות חכמות</div>
          </div>
          <div id="suggestionsList"></div>
        </div>

        <!-- Rule of 72 Calculator -->
        <div class="settings-panel glass-intense">
          <div class="settings-header">
            <div class="settings-title">📈 חוק 72 - חישוב הכפלת הון</div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="rule72Rate">ריבית שנתית (%)</label>
              <input type="number" id="rule72Rate" placeholder="4.0" step="0.1" min="0.1" max="50">
            </div>
            <div class="form-group">
			  <label for="rule72Result">שנים להכפלת הון</label>
			  <input id="rule72Result" type="text" readonly
					 class="rule72-input"
					 aria-live="polite"
					 placeholder="יחושב אוטומטית">
			</div>
          </div>
          <div class="info-note">
            חוק 72: הון יוכפל תוך <strong id="rule72Years">0</strong> שנים
            בריבית של <strong id="rule72DisplayRate">0%</strong>
          </div>
        </div>

        <div class="settings-panel glass-intense">
          <div class="settings-header">
            <div class="settings-title">📈 מדריך ROI לקבלת החלטות</div>
          </div>
          <div class="roi-guide-grid">
            <div class="roi-tier roi-excellent">
              <div style="font-weight: 700; color: var(--success); margin-bottom: 6px;">🚀
                מעולה: 6%+</div>
              <div style="font-size: 0.85rem; color: var(--text-secondary);">השקעות
                מצוינות לטווח ארוך</div>
            </div>
            <div class="roi-tier roi-ok">
              <div style="font-weight: 700; color: var(--warning); margin-bottom: 6px;">📈
                טוב: 4-6%</div>
              <div style="font-size: 0.85rem; color: var(--text-secondary);">תשואה
                סבירה ובטוחה</div>
            </div>
            <div class="roi-tier roi-weak">
              <div style="font-weight: 700; color: var(--accent-primary); margin-bottom: 6px;">📊
                בינוני: 2-4%</div>
              <div style="font-size: 0.85rem; color: var(--text-secondary);">כמעט
                מכסה אינפלציה</div>
            </div>
            <div class="roi-tier roi-bad">
              <div style="font-weight: 700; color: var(--danger); margin-bottom: 6px;">⚠️
                חלש: מתחת ל-2%</div>
              <div style="font-size: 0.85rem; color: var(--text-secondary);">לא
                עוקב אחרי אינפלציה</div>
            </div>
          </div>

          <div class="roi-tips">
            <h4 style="margin: 0 0 8px; color: var(--accent-primary);">💡
              טיפים לROI טוב יותר:</h4>
            <ul style="margin: 0; padding-right: 20px; font-size: 0.9rem; color: var(--text-secondary);">
              <li>מטרות ארוכות טווח (5+ שנים) מאפשרות ROI גבוה יותר</li>
              <li>התחל לחסוך מוקדם - זמן הוא הנכס החשוב ביותר</li>
              <li>שקול תיקי השקעה מאוזנים לטווח ארוך</li>
              <li>מטרות קצרות טווח (1-2 שנים) - העדף בטיחות על תשואה</li>
            </ul>
          </div>
        </div>

        <!-- Export Section -->
        <div class="settings-panel glass-intense">
          <div class="settings-header">
            <div class="settings-title">📄 ייצוא דוח מקצועי</div>
            <button id="exportPdfBtn" class="btn btn-primary">
              📑 ייצא PDF מעוצב
            </button>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="clientName">שם הלקוח (אופציונלי)</label>
              <input type="text" id="clientName" placeholder="שם מלא">
            </div>
            <div class="form-group">
              <label for="advisorName">שם היועץ (אופציונלי)</label>
              <input type="text" id="advisorName" placeholder="שם היועץ הפיננסי">
            </div>
          </div>
        </div>

        <div class="info-note" id="timeToGoal">זמן לסיום: 0 חודשים</div>
        <div class="info-note" id="explainMonthly" style="margin-top: 8px;"></div>

        <!-- Settings Panel -->
        <div class="settings-panel glass-intense">
          <div class="settings-header">
            <div class="settings-title">⚙️ תצורת חישוב ושמירה</div>
            <div class="toolbar">
              <button class="btn btn-danger" id="resetBtn" data-tooltip="מחיקת כל הנתונים">איפוס מלא</button>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="inflationPct">אינפלציה שנתית משוערת (%)</label>
              <input type="number" id="inflationPct" placeholder="2.0" step="0.1" min="0" max="15">
            </div>
            <div class="form-group">
              <label for="monthlyIncome">הכנסה חודשית נטו (₪)</label>
              <input type="text" inputmode="decimal" id="monthlyIncome" data-format="money" placeholder="15000" min="0">
              <span class="info-note">לבדיקות בטיחות פיננסיות</span>
            </div>
            <div class="form-group">
              <label for="globalSaved">חיסכון נוכחי כללי (₪)</label>
              <input type="text" inputmode="decimal" id="globalSaved" data-format="money" placeholder="0" min="0">
              <span class="info-note">מוקצה אוטומטית למטרות (קודם ביעדים
                הקרובים)</span>
            </div>
            <!-- הוסף בשורה של הטופס הקיים (אפשר אחרי globalAnnualRate / computeReal) -->
            <div class="form-group">
              <label for="generalMonthlyDeposit">הפקדה חודשית כללית (₪)</label>
              <input type="text" inputmode="decimal" id="generalMonthlyDeposit" data-format="money"
                placeholder="לדוגמה: 1,500" min="0">
              <span class="info-note">זה הסכום החודשי שמיועד לחיסכון כולל לפני חלוקה למטרות.</span>
            </div>

            <!-- מחוץ לשדות, כתצוגה אינפורמטיבית (אפשר מיד אחרי ה-form-row) -->
            <div class="existing-capital-display">
              <div>הפקדה חודשית פנויה לאחר הקצאה למטרות:
                <span id="freeMonthlyDeposit" class="capital-amount">—</span>
              </div>
              <!-- <span class="info-note">= הפקדה כללית − סכום ההפקדות של כל המטרות הפעילות.</span> -->
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="globalAnnualRate">ריבית שנתית על חיסכון כללי (%)</label>
              <input id="globalAnnualRate" type="number" step="0.01" min="0" max="50" placeholder="לדוגמה: 3.00">
            </div>
            <div class="form-group">
              <label for="computeReal">חישוב ריאלי (בערכי היום)</label>
              <div class="checkbox-container glass-subtle">
                <input type="checkbox" id="computeReal">
                <span class="info-note">במצב ריאלי:
                  $r_{\text{real}} = \frac{1+i}{1+\pi} - 1$</span>
              </div>
            </div>
          </div>
        </div>

        <!-- אנליזת רגישות -->
        <div class="settings-panel glass-intense">
          <div class="settings-header">
            <div class="settings-title">📊 אנליזת רגישות</div>
          </div>
          <div class="sensitivity-controls">
            <label>שינוי ריבית: <span id="rateChangeDisplay">0.0%</span></label>
            <input type="range" id="sensitivitySlider" min="-5" max="5" step="0.1" value="0">
            <div id="sensitivityResults"></div>
          </div>
        </div>

        <!-- מערכת אזהרות -->
        <div id="warningsContainer" class="warnings-container"></div>

        <!-- Breakdown Table -->
        <div id="breakdownSection" style="display:none">
		  <h3 class="chart-title">פירוט לפי מטרות</h3>
		  <div class="table-container glass-intense">
			<table>
			  <thead>
				<tr>
				  <th>מטרה</th>
				  <th>סכום יעד</th>
				  <th>זמן נותר</th>
				  <th>ריבית שנתית</th>
				  <th>חיסכון חודשי</th>
				  <th>ROI</th>
				  <th>חוק 72</th>
				  <th>הון קיים</th>
				  <th>יתרה חופשית</th>
				  <th>רווח ריבית</th> <!-- ✅ חדש -->
				  <th>פער מהיעד</th>   <!-- ✅ חדש -->
				</tr>
			  </thead>
			  <tbody id="breakdownTableBody"></tbody>
			</table>
		  </div>
		</div>


        <div class="status-message status-warning" id="warningMessage" style="display:none">
          ⚠️ יש מטרות עם תאריך יעד שחלף — עדכן/י בבקשה את התאריך.
        </div>
      </section>
    </div>

    <!-- Chart Section -->
    <section class="card chart-container animate-in glass-intense" id="chartSection" style="display:none">
      <!-- <div class="zoom-controls">
        <button class="zoom-btn" onclick="zoomIn()" title="זום פנימה">+</button>
        <button class="zoom-btn" onclick="zoomOut()" title="זום החוצה">−</button>
        <button class="zoom-btn" onclick="resetZoom()" title="איפוס זום">⌂</button>
      </div> -->

      <h3 class="chart-title">📈 גרף צבירת חיסכון (קווים למטרות + סה"כ
        מקווקו)</h3>
      <canvas id="savingsChart"></canvas>
    </section>
  </div>

  <!-- Bonus Modal -->
  <div id="bonusModal" class="modal hidden" aria-hidden="true" aria-labelledby="bonusModalTitle" role="dialog">
    <div class="modal-backdrop" data-close="1"></div>
    <div class="modal-dialog" role="document">
      <div class="modal-header">
        <h3 id="bonusModalTitle">הוספת בונוס חד־פעמי</h3>
        <button type="button" class="modal-close" data-close="1" aria-label="סגור">×</button>
      </div>

      <form id="bonusForm" class="modal-body" novalidate>
        <div class="form-row">
          <div class="form-group">
            <label for="bonusAmountInput">סכום הבונוס (₪)</label>
            <input id="bonusAmountInput" data-format="money" inputmode="decimal" type="text" placeholder="10,000">
            <span class="hint">ניתן להקליד מספר — הפסיקים יתווספו אוטומטית</span>
          </div>

          <div class="form-group">
            <label for="bonusMonthInput">באיזה חודש בתכנית? (1-120)</label>
            <select id="bonusMonthInput" style="direction:ltr; text-align:center;"></select>
            <span class="hint">1 = החודש הראשון בתכנית, 120 = סוף השנה החמישית</span>
          </div>

          <div class="form-group" style="grid-column: 1 / -1;">
            <label for="bonusDescInput">תיאור (אופציונלי)</label>
            <input id="bonusDescInput" type="text" placeholder="בונוס / החזר מס / מתנה">
          </div>
        </div>

        <div id="bonusError" class="form-error" aria-live="polite"></div>

        <div class="modal-actions">
          <button type="button" class="btn btn-secondary" data-close="1">בטל</button>
          <button type="submit" class="btn btn-primary">הוסף בונוס</button>
        </div>
      </form>
    </div>
  </div>



  <!-- Goal Editor Modal -->
  <div id="goalEditor" class="modal hidden" aria-hidden="true" style="
	  position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
	  background:rgba(0,0,0,0.45); z-index:9999;">
    <div class="card glass-intense" style="width: min(1000px, 95vw); max-height: 90vh; overflow:auto; padding:20px;">
      <h3 style="margin-top:0">עריכת מטרה</h3>
      <div class="form-row">
        <div class="form-group">
          <label for="editCalculationMode">מצב חישוב</label>
          <select id="editCalculationMode" onchange="toggleEditCalculationMode()">
            <option value="standard">רגיל: סכום + תאריך ← חיסכון
              חודשי</option>
            <option value="amount_payment">חישוב סכום: חיסכון חודשי + תאריך ←
              סכום יעד</option>
            <option value="date_payment">חישוב תאריך: סכום + חיסכון חודשי ←
              תאריך יעד</option>
          </select>
        </div>
        <div class="form-group">
          <label for="editGoalName">שם המטרה</label>
          <input id="editGoalName" type="text" placeholder="שם מטרה">
        </div>
        <div class="form-group">
          <label for="editGoalAmount">סכום יעד (₪)</label>
          <input id="editGoalAmount" data-format="money"  type="text" inputmode="decimal"  step="1" min="1">
        </div>
        <div class="form-group">
          <label for="editGoalDate">תאריך יעד (dd/mm/yyyy)</label>
          <input id="editGoalDate" type="text" placeholder="dd/mm/yyyy">
        </div>
        <div class="form-group" id="editMonthlyPaymentGroup" style="display: none;">
          <label for="editMonthlyPayment">חיסכון חודשי (₪)</label>
          <input id="editMonthlyPayment" data-format="money"  type="text" inputmode="decimal"  placeholder="1,000" min="1">
        </div>
        <div class="form-group">
          <label for="editGoalRate">ריבית שנתית (%)</label>
          <input id="editGoalRate" type="number" step="0.1" min="0" max="50">
        </div>
        <div class="form-group">
          <label for="editExistingCapital">הון קיים למטרה (₪)</label>
          <input id="editExistingCapital" data-format="money"  type="text" inputmode="decimal"  min="0" step="0.01"
            placeholder="0">
          <small class="hint" style="color: var(--text-muted); font-size: 0.85rem; margin-top: 4px; display: block;">
            סכום שכבר קיים עבור המטרה
          </small>
        </div>
        <div class="form-group">
          <label for="editSavingsType">סוג חיסכון</label>
          <select id="editSavingsType">
            <option value="fixed">קבוע</option>
            <option value="progressive">הדרגתי</option>
          </select>
        </div>
        <div class="form-group" id="editProgressiveRow" style="display:none">
          <label for="editMonthlyIncrease">עלייה חודשית (₪)</label>
          <input id="editMonthlyIncrease" data-format="money"  type="text" inputmode="decimal" step="1" min="0">
        </div>
      </div>

      <div class="divider" style="margin:12px 0; border-top:1px solid rgba(255,255,255,0.1)"></div>

      <h4 style="margin:0 0 8px">בונוסים</h4>
      <div id="editBonusesContainer"></div>
      <!-- <button class="btn btn-alt" id="quickAddBonusBtn">➕ הוסף בונוס</button> -->

      <div style="display:flex; gap:8px; justify-content:flex-end; margin-top:16px">
        <button id="closeGoalEditorBtn" class="btn">בטל</button>
        <button id="saveGoalEditBtn"  class="btn btn-primary" >שמור</button>
      </div>
    </div>
  </div>
  <div id="sysmsg-toasts" class="sysmsg-toasts" aria-live="polite" aria-atomic="false"></div>
<script type="module">
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
    mermaid.initialize({
      startOnLoad: true,
      theme: "dark",
      themeVariables: {
        primaryColor: "#1e88e5",
        primaryTextColor: "#fff",
        primaryBorderColor: "#1565c0",
        lineColor: "#90caf9",
        secondaryColor: "#43a047",
        tertiaryColor: "#e53935"
      }
    });
  </script>
  
  <script>
  
    window.addEventListener('load', () => {
      console.log('💼 מחשבון מטרות פיננסיות פרימיום הוטען בהצלחה!');
    });

    function sendHeight() {
      try {
        const h = Math.max(
          document.body.scrollHeight,
          document.documentElement.scrollHeight
        );
        window.parent.postMessage({ type: 'resize-one-off-family-goals-race', height: h }, '*');
      } catch (e) { }
    }

    window.addEventListener('load', sendHeight);
    window.addEventListener('resize', sendHeight);
    setInterval(sendHeight, 2000);
	
	</script>

  <script type="module" src="./js/app.bootstrap.js"></script>
</body>

</html>